# Rate Limiter Configuration
# https://symfony.com/doc/current/rate_limiter.html

framework:
    rate_limiter:
        # Login rate limiter: 5 attempts per minute per email
        # Used to prevent brute force attacks on authentication
        login:
            policy: 'sliding_window'
            limit: 5
            interval: '1 minute'

        # API rate limiter: 1000 requests per hour
        # General rate limiting for API endpoints
        api:
            policy: 'sliding_window'
            limit: 1000
            interval: '1 hour'

        # Registration rate limiter: 10 attempts per hour per IP
        # Prevents spam account creation
        registration:
            policy: 'sliding_window'
            limit: 10
            interval: '1 hour'

when@test:
    framework:
        rate_limiter:
            # Low limits for testing 429 responses
            # Uses filesystem cache for persistence between test requests
            # Each test clears the cache in setUp for isolation
            login:
                policy: 'sliding_window'
                limit: 5
                interval: '1 minute'
                cache_pool: rate_limiter.cache
            api:
                policy: 'sliding_window'
                limit: 5
                interval: '1 minute'
                cache_pool: rate_limiter.cache
            registration:
                policy: 'sliding_window'
                limit: 5
                interval: '1 minute'
                cache_pool: rate_limiter.cache
